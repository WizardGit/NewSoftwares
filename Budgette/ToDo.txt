SQL queries for actually doing the transaction need to be reviewed (there's an error) and minimized for in case one query fails